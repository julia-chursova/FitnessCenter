@model IEnumerable<FitnessCenter.Entities.TimetableItem>

@{
    ViewBag.Title = "Timetable";
    Layout = "~/Views/Shared/_Layout1.cshtml";
}

<h2>Timetable</h2>

<table class="table">
    <tr>
        <th>

        </th>
        <th>Понедельник</th>
        <th>Вторник</th>
        <th>Среда</th>
        <th>Четверг</th>
        <th>Пятница</th>
        <th>Суббота</th>
        <th>Воскресенье</th>
    </tr>
    @if (Model.Count() > 0)
    {
        for (int j = 0; j < (Model.Max(e => e.EndTime) - Model.Min(s => s.StartTime)).Hours + 1; j++)
        {
            <tr>
                <td>
                    @{
            var t = new TimeSpan(j, 0, 0);
            var tt = t + Model.Min(s => s.StartTime);
            <p>@tt</p>
                    }
                </td>
                <td>
                    @{
            var items = Model.Where(i => i.DayOfWeek == 1 && i.StartTime >= tt && i.StartTime < tt + new TimeSpan(1, 0, 0));
            foreach (var item in items)
            {
                @item.Activity.Name <br/>
                        @item.Room.Name <br/>
                        @item.Employee.FullName <br/>
    <p>@item.StartTime.ToString("hh\\:mm") - @item.EndTime.ToString("hh\\:mm")</p>
            }
}                    
                </td>
                <td>
                    @{
            items = Model.Where(i => i.DayOfWeek == 2 && i.StartTime >= tt && i.StartTime < tt + new TimeSpan(1, 0, 0));
            foreach (var item in items)
            {
                @item.Activity.Name <br />
                @item.Room.Name <br />
                @item.Employee.FullName <br />
                <p>@item.StartTime.ToString("hh\\:mm") - @item.EndTime.ToString("hh\\:mm")</p>
            }
}
                </td>
                <td>
                    @{
            items = Model.Where(i => i.DayOfWeek == 3 && i.StartTime >= tt && i.StartTime < tt + new TimeSpan(1, 0, 0));
            foreach (var item in items)
            {
                @item.Activity.Name <br />
                @item.Room.Name <br />
                @item.Employee.FullName <br />
                <p>@item.StartTime.ToString("hh\\:mm") - @item.EndTime.ToString("hh\\:mm")</p>
            }
}
                </td>
                <td>
                    @{
            items = Model.Where(i => i.DayOfWeek == 4 && i.StartTime >= tt && i.StartTime < tt + new TimeSpan(1, 0, 0));
            foreach (var item in items)
            {
                @item.Activity.Name <br />
                @item.Room.Name <br />
                @item.Employee.FullName <br />
                <p>@item.StartTime.ToString("hh\\:mm") - @item.EndTime.ToString("hh\\:mm")</p>
            }
}
                </td>
                <td>
                    @{
            items = Model.Where(i => i.DayOfWeek == 5 && i.StartTime >= tt && i.StartTime < tt + new TimeSpan(1, 0, 0));
            foreach (var item in items)
            {
                @item.Activity.Name <br />
                @item.Room.Name <br />
                @item.Employee.FullName <br />
                <p>@item.StartTime.ToString("hh\\:mm") - @item.EndTime.ToString("hh\\:mm")</p>
            }
}
                </td>
                <td>
                    @{
            items = Model.Where(i => i.DayOfWeek == 6 && i.StartTime >= tt && i.StartTime < tt + new TimeSpan(1, 0, 0));
            foreach (var item in items)
            {
                @item.Activity.Name <br />
                @item.Room.Name <br />
                @item.Employee.FullName <br />
                <p>@item.StartTime.ToString("hh\\:mm") - @item.EndTime.ToString("hh\\:mm")</p>
            }
}
                </td>
                <td>
                    @{
            items = Model.Where(i => i.DayOfWeek == 7 && i.StartTime >= tt && i.StartTime < tt + new TimeSpan(1, 0, 0));
            foreach (var item in items)
            {
                @item.Activity.Name <br />
                @item.Room.Name <br />
                @item.Employee.FullName <br />
                <p>@item.StartTime.ToString("hh\\:mm") - @item.EndTime.ToString("hh\\:mm")</p>
            }
}
                </td>
            </tr>
        }
    }
</table>

